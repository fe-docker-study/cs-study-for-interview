# 네트워크1 

## 프로토콜

- 통신하기 위한 데이터 형식 등의 규칙
- 복수의 프로토콜을 조합한 것이 네트워크 아키텍처(프로토콜 스택, 프로토콜 스위트)
- 프로토콜은 데이터 형식(정보를 어떤 형식으로 전송할지 정의)과 통신절차(어떤 순서로 무엇을 주고받을지 정의)로 이뤄짐

## 프로토콜 계층구조

- 레이어 구조로 하는 이유는 '보다 공통적인 기능'을 아래에 두고 '더 개별적인 기능'을 위에 둬서 상위의 기능이 하위의 기능을 이용하기 위함

  | 상위계층 | 개별적이거나 복잡한 기능을 구현할 규칙 |
  | -------- | -------------------------------------- |
  | 하위계층 | 공통적이거나 단순한 기능을 위한 규칙   |

- 계층끼리의 경계가 생기게 됨에 따라 프로토콜의 자리매김이 명확해져서 교체하기 쉬워짐

### OSI 모델

- 컴퓨터 네트워크에서 필요로 하는 기능을 일곱개의 계층을 이용해서 정리한 것
- 하위 계층은 상위 계층에 비해 추상화된 기능을 제공, 상위 계층은 하위 계층의 기능을 이용해 자체 기능을 구현

| 레이어 7 | 응용 계층        | 구체적인 통신 서비스를 구현(메일, web 등)       |
| -------- | ---------------- | ----------------------------------------------- |
| 레이어 6 | 표현 계층        | 데이터 표현형식을 상호 변환                     |
| 레이어 5 | 세션 계층        | 통신의 시작부터 종료까지의 절차를 구현          |
| 레이어 4 | 전송 계층        | 신뢰도 향상 등 용도에 따른 특성을 구현          |
| 레이어 3 | 네트워크 계층    | 중계 등에 의한 임의의 기기간의 통신을 구현      |
| 레이어 2 | 데이터 링크 계층 | 직접 접속된 기기간의 통신을 구현                |
| 레이어 1 | 물리 계층        | 커넥터 모양이나 필 개수 등 물리적인 접속을 결정 |

- OSI 참조 모델과 프로그램의 관계

  | 응용 계층        | 응용 프로그램               |
  | ---------------- | --------------------------- |
  | 표현 계층        | 응용 프로그램               |
  | 세션 계층        | 응용 프로그램               |
  | 전송 계층        | TCP처리 모듈 / UDP 처리모듈 |
  | 네트워크 계층    | IP 처리 모듈                |
  | 데이터 링크 계층 | 이더넷(Ethernet) 제어 모듈  |
  | 물리 계층        | 이더넷 하드웨어             |

### TCP/IP 프로토콜 그룹

- 인터넷을 비롯한 컴퓨터 네트워크에서 널리 이용되는 통신 프로토콜

- 4층의 모델

  | 애플리케이션층        | 구체적인 통신 서비스를 구현(메일,Web 등)                     | HTTP, SMTP, POP3, IMAP4 등 다수 |
  | --------------------- | ------------------------------------------------------------ | ------------------------------- |
  | 트랜스포트층          | 고신뢰도 등 목적에 맞는 통신 품질 구현                       | TCP, UDP 등                     |
  | 인터넷층              | 네트워크 인터페이스층을 기반으로 중계 등의 기능을 추가해 다른 네트워크 내의 대상과 통신할 수 있는 기능 구현 | IP, ICMP 등                     |
  | 네트워크 인터페이스층 | 직접 접속된 기기간의 통신을 구현(이더넷에 준거하는 네트워크 카드 등이 이 층의 기능 구현) | 이더넷, APP/RARP 등             |

- TCP : 데이터의 확인이나 재전송 등을 수행하며 신뢰도가 높은 통신을 구현하는 프로토콜

- UDP : 통신을 가볍게 처리하도록 해 실시간 성격이 큰 통신을 구현

- 애플리케이션은 각 층의 프로토콜을 조합해서 사용함

  ![Untitled](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/5bd9a550-0e30-4ce2-8e5d-7915fbfd6252/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20211128%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20211128T152912Z&X-Amz-Expires=86400&X-Amz-Signature=8a76ac4d8afc6515af6da00c195e322a244967f2b168f8344c3eeff2da7823af&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22&x-id=GetObject)

#### 네트워크 인터페이스층

- 직접 연결되어 있는 컴퓨터간 통신을 담당(이 층만으로 다른 네트워크와 통신할 수 없음)
- 이 층을 구성하는 네트워크 하드웨어는 보통 하드웨어 별로 고유의 주소를 갖고 있음
- 주요 프로토콜
  - 이더넷 : 유선LAN에서 가장 주류인 네트워크 규격
  - Wi-Fi : 무선을 사용해서 LAN에 접속하기 위한 규격
  - PPPoE(Point-to-Point Protocol over Ethernet) : 이더넷 위에서 1대1의 접속하게 하는 프로토콜, 인터넷 접속 서비스의 이용자 인증에 많이 사용
  - ARP/RARP : IP 주소와 MAC 주소를 서로 교환하기 위한 프로토콜, 이더넷이나 Wi-Fi 위에서 사용

#### 인터넷층

- 인터 네트워킹, 다시 말해 복수개의 네트워크를 연결해서 서로 패킷을 교환하는 기능을 구현
- 패킷을 중계해서 소정의 방향으로 전송하는 것을 라우팅(routing)이라고 하며, 라우팅으로 네트워크 인터페이스층만으로는 도달할 수 없던 임의의 대상에게 데이터를 전송
- 컴퓨터를 식별하기 위한 주소를 부여. 이 주소는 네트워크 인터페이스층의 프로토콜과 상관없도록 하드웨어주소(MAC 주소 등)와는 무관하면서도 접속한 네트워크 전체에서 컴퓨터를 하나하나 식별할 수 있어야함.
- 주요 프로토콜
  - IP : 직접 연결되어 있지 않은 네트워크끼리 패킷을 라우팅하는 기능을 제공하는 프로토콜. 이 동작에 따라 직접 연결 여부에 관계없이 임의의 컴퓨터와 통신할 수 있음
  - ICMP : IP 동작을 보조하기 위한 특수 기능을 보유한 프로토콜. 임의의 대상에게 도달할 수 있을지 검사, 도착할 수 없는 경우의 이유를 통지하는 등에 사용

#### 트랜스포트층

- 인터넷층이 만들어낸 임의의 컴퓨터끼리의 통신 기능을 기반으로 해서 네트워크 사용 목적에 따른 특성을 가진 통신을 구현
- 주요 프로토콜
  - TCP : 임의의 컴퓨터끼리 하는 통신으로 고신뢰도를 보장하는 프로토콜. 초기 연결하여 통신이 완료되면 연결을 끊음. 재전송이나 순서 재배치 등을 하므로 실시간성 작업에는 맞지 않음(web을 위한 HTTP, 메일 송수신을 위한 SMTP 등 인터넷 애플리케이션에서 폭넓게 사용)
  - UDP : 인터넷층의 기능을 대부분 그대로 사용하고 사전 준비가 필요하지 않으며 간단한 통신을 구현하는 프로토콜. 필요할 때 대상한테 바로 데이터를 보내고 도착한 데이터는 바로 애플리케이션으로 전달(송출한 패킷이 빠르게 도달한다는 특성에 맞춰 음악이나 동영상 스트리밍, 인터넷 전화 등에 사용. 또한 사전 연결이 불필요하다는 특성이 있으므로 DNS나 NTP 등 서버에 빈번하게 문의하는 용도로 이용)

#### 애플리케이션층

- 트랜스포트층이 만들어내는 목적에 맞는 통신기능 중에서 애플리케이션에 적합한 것을 골라서 이를 사용하는 애플리케이션 프로그램끼리 데이터를 주고받음(애플리케이션의 개별 기능을 구현- 애플리케이션은 통신 기능을 사용하는 프로그램 전체)
- 주요 프로토콜
  - HTTP : Web 접속에 사용
  - SMTP : 메일 송신이나 서버간 전송
  - POP3: 메일함에서 메일을 꺼냄
  - IMAP4 : 메일함의 메일을 읽음
  - FTP : 파일 전송에 사용
  - SSH : 문자 기반으로 서버 등에 명령을 하고 결과를 봄
  - DNS : 도메인 명과 IP 주소를 상호 변환
  - NTP : 네트워크 시간 동기화에서 사용

## 기반기술

### 근거리 통신망 - LAN(Local Area Network)

- 사무실이나 가정 등 거점 한 군데 내의 네트워크
- LAN의 규격으로 최근에는 이더넷을 사용

### 원거리 통신망 - WAN(Wide Area Network)

- 거점과 거점을 연결하기 위한 네트워크
- 대부분은 통신사업자가 소유하고, 회선을 대여해 사용
- 인터넷 접속 서비스를 사용하기 위해서 사물실이나 가정에서 끌어다 쓰는 회선을 WAN 이라고 부르는 경우도 있음
- 기업 내에서 사용되는 WAN :
  - 광역 이더넷 서비스
    - 지정할 거점끼리 이더넷으로 직접 연결할 수 있음
    - 이더넷의 연장으로 이용할 수 있어 특별한 기기가 필요하지 않음
    - 안정성이 높고, 속도가 빠르나 요금이 비쌈
  - 인터넷 VPN (Virtual Private Network)
    - VPN은 토대가 되는 어떤 네트워크 내에서 별개의 가상 네트워크를 만드는 기술로, 인터넷을 사용하며 보안을 위해 암호화를 병용
    - 일반적인 인터넷 이용료로 손쉽게 이용가능하나 보안은 광역 이더넷보다 낮고 속도가 일정하지 않음

## 네트워크 계층

### 네트워크 계층에서의 패킷 교환

#### 패킷

- 일반적으로 데이터를 일정한 크기로 작게 나눠서 그 앞에 헤더를 추가한 형태
- 헤더에는 이걸 전달할 주소나 송신처 정보, 포함하고 있는 데이터에 관한 정보 등 통신처리에 필요한 각종 정보를 담고 있음
- 구체적인 패킷의 형태는 프로토콜별로 데이터 형식으로 정의
- 네트워크 인터페이스 규격의 하나인 이더넷에서는 동일하게 데이터를 작게 자른 것을 프레임이라고 부름(하드웨어와 밀접한 관계가 있는 것을 프레임, 소프트웨어에서의 처리가 중심이 되는 것을 패킷이라고 부르는 경우가 많음)

#### 패킷 교환

- 주고받고자 하는 데이터를 패킷이라고 불리는 작은 크기의 데이터로 작게 나눠서 이걸 공용 통신회선을 통해서 운반
- 회선을 공용으로 사용하므로 특정 기기간에 사용하지 않을 때는 다른 이의 패킷을 전송할 수 있으므로 이용효율을 높임

#### 레이어별 처리와 패킷의 관계

- 전송하는 층의 처리와 헤더추가 : 데이터를 전송하는 측에서 상위층에서 받은 데이터를 기반으로 어떤 형태로든 통신을 처리하며, 그 통신처리 필요한 정보를 앞에 추가(헤더)하고 하위층에 넘김
- 수신받는 층의 처리와 헤더제거 : 데이터를 받는 측에서는 하위층에서 받은 패킷에 포함된 헤더 부분의 정보를 사용해 필요한 정보를 처리하고, 헤더부분을 제거하고 상위층에 넘김

![Untitled](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/9c6be4ec-0714-4f27-9920-b0097e6ad86a/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20211128%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20211128T152935Z&X-Amz-Expires=86400&X-Amz-Signature=27adec0c8582ff8d8f5e62f345b1b73d37705d96de2d847b067c634c7c282d65&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22&x-id=GetObject)

## IPv4주소

- IP 주소는 IP라고 불리는 프로토콜을 사용하는 네트워크에서 각 컴퓨터를 식별하기 위해 컴퓨터에 부여된 주소
- 네 개의 숫자(0~255)를 점으로 구분해서 표시, 단순 계산으로는 약 42.9억개의 컴퓨터에 할당 가능
- IP 주소는 계층적으로 할당 : 인터넷에 관한 번호를 관리하는 ICANN → 지역인터넷 레지스트리(아시아 태평양 지역의 네트워크 자원을 관리하는 APNIC) → 국가별 인터넷 레지스트리(한국의 네트워크 자원을 관리하는 KRNIC) → 로컬 인터넷 레지스트리(ISP나 데이터 사업자) → 사용자에게 할당
- IP 주소는 네트워크부(네트워크를 특정하는 정보)와 호스트부(그 네트워크 안 컴퓨터를 특정)로 구성

### IPv4 클래스 기반 주소지정

- IP 주소에는 클래스라는 개념이 있고, A부터 C는 일반적인 주소로 사용되고 D와 E는 특수한 용도로 사용됨
- A~C는 한개의 네트워크 주소 안에서 몇대의 컴퓨터를 구별할 수 있는 지(호스트부 크기), 즉 네트워크 규모의 차이(A는 대규모 네트워크용, C는 소규모용 네트워크용)
- IP 주소의 네트워크부에 해당하는 부분을 1로 한 비트의 나열을 넷마스크라고 함. 이 넷마스크와 IP주소를 대상으로 AND 연산을 하면 호스트부가 0이 돼 네트워크 주소를 추려낼 수 있음

![Untitled](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/9a258039-5255-46e2-a9c5-97f93643255c/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20211128%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20211128T153249Z&X-Amz-Expires=86400&X-Amz-Signature=45d8ae53363386838ca90a0ae8243a9aa2c010049d58951372f4274d1e3230f6&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22&x-id=GetObject)

### 서브넷화와 서브넷 마스크

- 서브넷화 : 한 개의 네트워크를 여러개의 서브넷으로 분할해 이들을 연결하는 구성
- 서브넷화를 하는 경우 IP주소 중에 네트워크부를 더욱 연장하고 그만큼 호스트부를 줄임
- 서브넷화 하는 경우 네트워크부가 연장된만큼 서브넷마스크의 1인부분도 연장(서브넷화 하는 경우의 넷마스크를 특히 서브넷 마스크라 하지만 일반적으로 넷마스크와 서브넷마스크를 구별하지 않고 사용하는 경우가 많음)

#### 작은 네트워크로 나눌 때의 이점

브로드캐스트가 닿는 범위가 한정되며 장애가 미치는 범위를 최소화하기 위해 조직의 네트워크를 한개의 거대한 형태로 처리하는 대신 작은 네트워크로 분리

(브로드캐스트란 네트워크 내의 전체 컴퓨터로의 일괄 전송을 가리키며 그 범위가 너무 넓으면 무관한 컴퓨터에도 쓸데없는 처리를 하게 하므로 네트워크 통신능력을 낭비하게 함)

### NAT(Network Address Translation)

- 몇 개의 전역 IP 주소를 라우터에 할당해두고 LAN 내의 컴퓨터가 인터넷에 접속할때 LAN 내의 컴퓨터가 인터넷에 접속할 때 이 중 하나를 이용해서 통신하는 방법
- LAN 내에서 인터넷에 IP 패킷을 전송할 때 사설 IP 주소를 전역 IP주소로 교체
- NAT 기능으로 IP 주소와의 대응현황을 기록